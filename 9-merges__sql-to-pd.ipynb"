{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"id":"C8hSMOgL7zpj","executionInfo":{"status":"ok","timestamp":1684393390803,"user_tz":-120,"elapsed":6260,"user":{"displayName":"Valeriia Satsiuk","userId":"02455586528434910686"}}},"outputs":[],"source":["# import libraries\n","import pandas as pd\n","\n","# load data\n","# This code is made to load our data stored on Google Drive\n","def gd_path(file_id):\n","    \"\"\"Generate a shareable link from Google Drive file id.\"\"\"\n","    return f\"https://drive.google.com/uc?export=download&id={file_id}\"\n","\n","# Google Drive file ids\n","files_id = {\n","    \"titles\": \"1PLdn50N9GRa53ZbuVWo0l47F_IXdvlEm\",\n","    \"stores\": \"1f-GCgip7O93CpbAkYvOsc21eKnSOSHsQ\", \n","    \"sales\": \"1fzFc9rwYmVIPaGOFmhLVxCi3kg19vNU2\", \n","    \"publishers\": \"1s9E8_AVOziTrowb3wyh2jg3PV763VOyq\",\n","    \"pub_info\": \"1OEgogcGKy--EpuVj0kqq7lyBZNGW6YSv\", \n","    \"jobs\": \"1V1Za8hUdXD-vJOyRdX4aQV5wanIff2eM\", \n","    \"employee\": \"1h9mUjsVqpP74b1w0x7KOw37n_n9Ulkt5\", \n","    \"discounts\": \"111dvSxMcCsTgOuV1wDSKFJxO1Xcxd9VS\", \n","}\n","\n","# Read data from Google Drive\n","sales = pd.read_csv(gd_path(files_id[\"sales\"]), sep=\";\")\n","titles = pd.read_csv(gd_path(files_id[\"titles\"]), sep=\";\")\n","employee = pd.read_csv(gd_path(files_id[\"employee\"]), sep=\";\")\n","stores = pd.read_csv(gd_path(files_id[\"stores\"]), sep=\";\")\n","publishers = pd.read_csv(gd_path(files_id[\"publishers\"]), sep=\";\")\n","# Replace the logos pandas can't read with '?'\n","pub_info = pd.read_csv(gd_path(files_id[\"pub_info\"]), sep=\";\", encoding_errors = 'replace')\n","discounts = pd.read_csv(gd_path(files_id[\"discounts\"]), sep=\";\")\n","jobs = pd.read_csv(gd_path(files_id[\"jobs\"]), sep=\";\")"]},{"cell_type":"markdown","metadata":{"id":"cLHL1opq7zp8"},"source":["# From SQL to pandas challenge 9"]},{"cell_type":"markdown","metadata":{"id":"880WAqAe7zqF"},"source":["##  1. Select the table sales, assigning the alias \"s\" to it. \n","   Select the column ord_num using the syntax `table_alias[column]`\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"c9TRcQQt7zqI"},"outputs":[],"source":["s = sales\n","s"]},{"cell_type":"code","source":["s['ord_num']"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"91c2o93pv7hZ","executionInfo":{"status":"ok","timestamp":1684176809521,"user_tz":-120,"elapsed":3,"user":{"displayName":"Valeriia Satsiuk","userId":"02455586528434910686"}},"outputId":"5e046745-fdfe-4e6d-c539-a7253500705c"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0         6871\n","1         722a\n","2        A2976\n","3     QA7442.3\n","4        D4482\n","5        P2121\n","6        P2121\n","7        P2121\n","8      N914008\n","9      N914014\n","10      P3087a\n","11      P3087a\n","12      P3087a\n","13      P3087a\n","14      QQ2299\n","15       TQ456\n","16        X999\n","17    423LL922\n","18    423LL930\n","19        P723\n","20     QA879.1\n","Name: ord_num, dtype: object"]},"metadata":{},"execution_count":20}]},{"cell_type":"markdown","metadata":{"id":"5SNDmigy7zqJ"},"source":["### Hint:"]},{"cell_type":"markdown","metadata":{"id":"KI4LGqk37zqL"},"source":["In SQL the syntax is:\n","\n","```sql\n","SELECT s.ord_num\n","FROM sales AS s;\n","```"]},{"cell_type":"markdown","metadata":{"id":"OQOwsEZt7zqW"},"source":["## 2. Select the title and publisher name of all books"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"kahIuGa37zqZ","colab":{"base_uri":"https://localhost:8080/","height":607},"executionInfo":{"status":"ok","timestamp":1684177322373,"user_tz":-120,"elapsed":6,"user":{"displayName":"Valeriia Satsiuk","userId":"02455586528434910686"}},"outputId":"b9ee762c-7369-4335-94a9-9c3ea5f92225"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                                title  pub_id\n","0                 The Busy Executive's Database Guide    1389\n","1   Cooking with Computers: Surreptitious Balance ...    1389\n","2                     You Can Combat Computer Stress!     736\n","3                       Straight Talk About Computers    1389\n","4                   Silicon Valley Gastronomic Treats     877\n","5                               The Gourmet Microwave     877\n","6                  The Psychology of Computer Cooking     877\n","7                            But Is It User Friendly?    1389\n","8                           Secrets of Silicon Valley    1389\n","9                                       Net Etiquette    1389\n","10  Computer Phobic AND Non-Phobic Individuals: Be...     877\n","11                                Is Anger the Enemy?     736\n","12                                  Life Without Fear     736\n","13      Prolonged Data Deprivation: Four Case Studies     736\n","14                Emotional Security: A New Algorithm     736\n","15  Onions, Leeks, and Garlic: Cooking Secrets of ...     877\n","16          Fifty Years in Buckingham Palace Kitchens     877\n","17                                     Sushi, Anyone?     877"],"text/html":["\n","  <div id=\"df-02122c5b-c2fa-4335-a21c-50910d566dcf\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>title</th>\n","      <th>pub_id</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>The Busy Executive's Database Guide</td>\n","      <td>1389</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Cooking with Computers: Surreptitious Balance ...</td>\n","      <td>1389</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>You Can Combat Computer Stress!</td>\n","      <td>736</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Straight Talk About Computers</td>\n","      <td>1389</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Silicon Valley Gastronomic Treats</td>\n","      <td>877</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>The Gourmet Microwave</td>\n","      <td>877</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>The Psychology of Computer Cooking</td>\n","      <td>877</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>But Is It User Friendly?</td>\n","      <td>1389</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>Secrets of Silicon Valley</td>\n","      <td>1389</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>Net Etiquette</td>\n","      <td>1389</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>Computer Phobic AND Non-Phobic Individuals: Be...</td>\n","      <td>877</td>\n","    </tr>\n","    <tr>\n","      <th>11</th>\n","      <td>Is Anger the Enemy?</td>\n","      <td>736</td>\n","    </tr>\n","    <tr>\n","      <th>12</th>\n","      <td>Life Without Fear</td>\n","      <td>736</td>\n","    </tr>\n","    <tr>\n","      <th>13</th>\n","      <td>Prolonged Data Deprivation: Four Case Studies</td>\n","      <td>736</td>\n","    </tr>\n","    <tr>\n","      <th>14</th>\n","      <td>Emotional Security: A New Algorithm</td>\n","      <td>736</td>\n","    </tr>\n","    <tr>\n","      <th>15</th>\n","      <td>Onions, Leeks, and Garlic: Cooking Secrets of ...</td>\n","      <td>877</td>\n","    </tr>\n","    <tr>\n","      <th>16</th>\n","      <td>Fifty Years in Buckingham Palace Kitchens</td>\n","      <td>877</td>\n","    </tr>\n","    <tr>\n","      <th>17</th>\n","      <td>Sushi, Anyone?</td>\n","      <td>877</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-02122c5b-c2fa-4335-a21c-50910d566dcf')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-02122c5b-c2fa-4335-a21c-50910d566dcf button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-02122c5b-c2fa-4335-a21c-50910d566dcf');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":35}],"source":["tit_pub = titles.merge(\n","    publishers,\n","    how='left',\n","    left_on='pub_id',\n","    right_on='pub_id'\n",")\n","tit_pub[['title', 'pub_id']]"]},{"cell_type":"markdown","metadata":{"id":"pN4FmlBb7zqc"},"source":["### Hint:"]},{"cell_type":"markdown","metadata":{"id":"njydZpY17zqe"},"source":["In SQL the syntax is:\n","\n","```sql\n","SELECT t.title, p.pub_name\n","FROM titles t\n","LEFT JOIN publishers p ON t.pub_id = p.pub_id;\n","```"]},{"cell_type":"markdown","metadata":{"id":"KF1m82807zqn"},"source":["## 3. Select the order number, quantity and book title for all sales."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Tb8AN1dO7zqn","colab":{"base_uri":"https://localhost:8080/","height":762},"executionInfo":{"status":"ok","timestamp":1684177480544,"user_tz":-120,"elapsed":248,"user":{"displayName":"Valeriia Satsiuk","userId":"02455586528434910686"}},"outputId":"6be7c034-d095-40ec-d262-4b963b9610f4"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["     ord_num   qty                                              title\n","0       6871   5.0                The Busy Executive's Database Guide\n","1   423LL930  10.0                The Busy Executive's Database Guide\n","2       P723  25.0  Cooking with Computers: Surreptitious Balance ...\n","3       X999  35.0                    You Can Combat Computer Stress!\n","4     QQ2299  15.0                      Straight Talk About Computers\n","5      TQ456  10.0                  Silicon Valley Gastronomic Treats\n","6    N914014  25.0                              The Gourmet Microwave\n","7   423LL922  15.0                              The Gourmet Microwave\n","8        NaN   NaN                 The Psychology of Computer Cooking\n","9    QA879.1  30.0                           But Is It User Friendly?\n","10     A2976  50.0                          Secrets of Silicon Valley\n","11       NaN   NaN                                      Net Etiquette\n","12    P3087a  20.0  Computer Phobic AND Non-Phobic Individuals: Be...\n","13      722a   3.0                                Is Anger the Enemy?\n","14  QA7442.3  75.0                                Is Anger the Enemy?\n","15     D4482  10.0                                Is Anger the Enemy?\n","16   N914008  20.0                                Is Anger the Enemy?\n","17    P3087a  25.0                                  Life Without Fear\n","18    P3087a  15.0      Prolonged Data Deprivation: Four Case Studies\n","19    P3087a  25.0                Emotional Security: A New Algorithm\n","20     P2121  40.0  Onions, Leeks, and Garlic: Cooking Secrets of ...\n","21     P2121  20.0          Fifty Years in Buckingham Palace Kitchens\n","22     P2121  20.0                                     Sushi, Anyone?"],"text/html":["\n","  <div id=\"df-5dc12e5c-b6ab-4378-882b-0aba1f2b3fa3\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>ord_num</th>\n","      <th>qty</th>\n","      <th>title</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>6871</td>\n","      <td>5.0</td>\n","      <td>The Busy Executive's Database Guide</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>423LL930</td>\n","      <td>10.0</td>\n","      <td>The Busy Executive's Database Guide</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>P723</td>\n","      <td>25.0</td>\n","      <td>Cooking with Computers: Surreptitious Balance ...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>X999</td>\n","      <td>35.0</td>\n","      <td>You Can Combat Computer Stress!</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>QQ2299</td>\n","      <td>15.0</td>\n","      <td>Straight Talk About Computers</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>TQ456</td>\n","      <td>10.0</td>\n","      <td>Silicon Valley Gastronomic Treats</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>N914014</td>\n","      <td>25.0</td>\n","      <td>The Gourmet Microwave</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>423LL922</td>\n","      <td>15.0</td>\n","      <td>The Gourmet Microwave</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>The Psychology of Computer Cooking</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>QA879.1</td>\n","      <td>30.0</td>\n","      <td>But Is It User Friendly?</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>A2976</td>\n","      <td>50.0</td>\n","      <td>Secrets of Silicon Valley</td>\n","    </tr>\n","    <tr>\n","      <th>11</th>\n","      <td>NaN</td>\n","      <td>NaN</td>\n","      <td>Net Etiquette</td>\n","    </tr>\n","    <tr>\n","      <th>12</th>\n","      <td>P3087a</td>\n","      <td>20.0</td>\n","      <td>Computer Phobic AND Non-Phobic Individuals: Be...</td>\n","    </tr>\n","    <tr>\n","      <th>13</th>\n","      <td>722a</td>\n","      <td>3.0</td>\n","      <td>Is Anger the Enemy?</td>\n","    </tr>\n","    <tr>\n","      <th>14</th>\n","      <td>QA7442.3</td>\n","      <td>75.0</td>\n","      <td>Is Anger the Enemy?</td>\n","    </tr>\n","    <tr>\n","      <th>15</th>\n","      <td>D4482</td>\n","      <td>10.0</td>\n","      <td>Is Anger the Enemy?</td>\n","    </tr>\n","    <tr>\n","      <th>16</th>\n","      <td>N914008</td>\n","      <td>20.0</td>\n","      <td>Is Anger the Enemy?</td>\n","    </tr>\n","    <tr>\n","      <th>17</th>\n","      <td>P3087a</td>\n","      <td>25.0</td>\n","      <td>Life Without Fear</td>\n","    </tr>\n","    <tr>\n","      <th>18</th>\n","      <td>P3087a</td>\n","      <td>15.0</td>\n","      <td>Prolonged Data Deprivation: Four Case Studies</td>\n","    </tr>\n","    <tr>\n","      <th>19</th>\n","      <td>P3087a</td>\n","      <td>25.0</td>\n","      <td>Emotional Security: A New Algorithm</td>\n","    </tr>\n","    <tr>\n","      <th>20</th>\n","      <td>P2121</td>\n","      <td>40.0</td>\n","      <td>Onions, Leeks, and Garlic: Cooking Secrets of ...</td>\n","    </tr>\n","    <tr>\n","      <th>21</th>\n","      <td>P2121</td>\n","      <td>20.0</td>\n","      <td>Fifty Years in Buckingham Palace Kitchens</td>\n","    </tr>\n","    <tr>\n","      <th>22</th>\n","      <td>P2121</td>\n","      <td>20.0</td>\n","      <td>Sushi, Anyone?</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-5dc12e5c-b6ab-4378-882b-0aba1f2b3fa3')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-5dc12e5c-b6ab-4378-882b-0aba1f2b3fa3 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-5dc12e5c-b6ab-4378-882b-0aba1f2b3fa3');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":39}],"source":["tit_sal = titles.merge(\n","    sales,\n","    how='left',\n","    left_on='title_id',\n","    right_on='title_id'\n",")\n","tit_sal[['ord_num', 'qty', 'title']]"]},{"cell_type":"markdown","metadata":{"id":"cYqCYQ1y7zqo"},"source":["### Hint:"]},{"cell_type":"markdown","metadata":{"id":"J2q4BP0_7zqp"},"source":["In SQL the syntax is:\n","\n","```sql\n","SELECT ord_num, qty, titles.title\n","FROM sales\n","RIGHT JOIN titles\n","ON sales.title_id=titles.title_id;\n","```"]},{"cell_type":"markdown","metadata":{"id":"c8C8neYJ7zqq"},"source":["## 4. Select the full name of all employees and the name of the publisher they work for"]},{"cell_type":"code","source":["emp_pub = employee.merge(\n","    publishers,\n","    how='left',\n","    left_on='pub_id',\n","    right_on='pub_id'\n",")\n","emp_pub['emp_name'] = emp_pub['fname'] + ' ' + emp_pub['lname']\n","emp_pub[['pub_name', 'emp_name']]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"yyitzFy4zX9Z","executionInfo":{"status":"ok","timestamp":1684178581649,"user_tz":-120,"elapsed":240,"user":{"displayName":"Valeriia Satsiuk","userId":"02455586528434910686"}},"outputId":"ed967abe-9163-4fb7-eb42-eef3953a309f"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                 pub_name           emp_name\n","0    Algodata Infosystems          Aria Cruz\n","1      Lucerne Publishing     Annette Roulet\n","2          Scootney Books          Ann Devon\n","3        Binnet & Hardley  Anabela Domingues\n","4      Lucerne Publishing    Carlos Hernadez\n","5    Algodata Infosystems     Carine Schmitt\n","6        Binnet & Hardley      Daniel Tonini\n","7    Algodata Infosystems         Diego Roel\n","8        Binnet & Hardley  Elizabeth Lincoln\n","9          Scootney Books    Francisco Chang\n","10         New Moon Books        Gary Thomas\n","11       Binnet & Hardley      Helen Bennett\n","12     Lucerne Publishing     Helvetius Nagy\n","13         New Moon Books      Howard Snyder\n","14                  GGG&G     Janine Labrune\n","15         New Moon Books      Karin Josephs\n","16     Lucerne Publishing    Karla Jablonski\n","17       Binnet & Hardley       Lesley Brown\n","18         New Moon Books   Laurence Lebihan\n","19   Algodata Infosystems      Maria Larsson\n","20     Lucerne Publishing     Manuel Pereira\n","21       Binnet & Hardley      Martine Rance\n","22   Algodata Infosystems     Miguel Paolino\n","23   Algodata Infosystems     Margaret Smith\n","24         New Moon Books      Martin Sommer\n","25         New Moon Books    Matti Karttunen\n","26      Ramona Publishers       Maria Pontes\n","27         New Moon Books       Mary Saveley\n","28     Lucerne Publishing   Patricia McKenna\n","29         New Moon Books        Palle Ibsen\n","30       Binnet & Hardley      Peter Franken\n","31       Binnet & Hardley      Paolo Accorti\n","32     Lucerne Publishing   Pirkko Koskitalo\n","33   Algodata Infosystems       Pedro Afonso\n","34   Algodata Infosystems      Paula Parente\n","35         Scootney Books      Philip Cramer\n","36       Binnet & Hardley       Paul Henriot\n","37         New Moon Books      Roland Mendel\n","38  Five Lakes Publishing        Rita Muller\n","39   Algodata Infosystems       Sven Ottlieb\n","40         New Moon Books   Timothy O'Rourke\n","41       Binnet & Hardley  Victoria Ashworth\n","42   Algodata Infosystems      Yoshi Latimer"],"text/html":["\n","  <div id=\"df-eb3830d1-9705-47f1-978c-b5c3b4140e9c\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>pub_name</th>\n","      <th>emp_name</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Algodata Infosystems</td>\n","      <td>Aria Cruz</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Lucerne Publishing</td>\n","      <td>Annette Roulet</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Scootney Books</td>\n","      <td>Ann Devon</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Binnet &amp; Hardley</td>\n","      <td>Anabela Domingues</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Lucerne Publishing</td>\n","      <td>Carlos Hernadez</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>Algodata Infosystems</td>\n","      <td>Carine Schmitt</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>Binnet &amp; Hardley</td>\n","      <td>Daniel Tonini</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>Algodata Infosystems</td>\n","      <td>Diego Roel</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>Binnet &amp; Hardley</td>\n","      <td>Elizabeth Lincoln</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>Scootney Books</td>\n","      <td>Francisco Chang</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>New Moon Books</td>\n","      <td>Gary Thomas</td>\n","    </tr>\n","    <tr>\n","      <th>11</th>\n","      <td>Binnet &amp; Hardley</td>\n","      <td>Helen Bennett</td>\n","    </tr>\n","    <tr>\n","      <th>12</th>\n","      <td>Lucerne Publishing</td>\n","      <td>Helvetius Nagy</td>\n","    </tr>\n","    <tr>\n","      <th>13</th>\n","      <td>New Moon Books</td>\n","      <td>Howard Snyder</td>\n","    </tr>\n","    <tr>\n","      <th>14</th>\n","      <td>GGG&amp;G</td>\n","      <td>Janine Labrune</td>\n","    </tr>\n","    <tr>\n","      <th>15</th>\n","      <td>New Moon Books</td>\n","      <td>Karin Josephs</td>\n","    </tr>\n","    <tr>\n","      <th>16</th>\n","      <td>Lucerne Publishing</td>\n","      <td>Karla Jablonski</td>\n","    </tr>\n","    <tr>\n","      <th>17</th>\n","      <td>Binnet &amp; Hardley</td>\n","      <td>Lesley Brown</td>\n","    </tr>\n","    <tr>\n","      <th>18</th>\n","      <td>New Moon Books</td>\n","      <td>Laurence Lebihan</td>\n","    </tr>\n","    <tr>\n","      <th>19</th>\n","      <td>Algodata Infosystems</td>\n","      <td>Maria Larsson</td>\n","    </tr>\n","    <tr>\n","      <th>20</th>\n","      <td>Lucerne Publishing</td>\n","      <td>Manuel Pereira</td>\n","    </tr>\n","    <tr>\n","      <th>21</th>\n","      <td>Binnet &amp; Hardley</td>\n","      <td>Martine Rance</td>\n","    </tr>\n","    <tr>\n","      <th>22</th>\n","      <td>Algodata Infosystems</td>\n","      <td>Miguel Paolino</td>\n","    </tr>\n","    <tr>\n","      <th>23</th>\n","      <td>Algodata Infosystems</td>\n","      <td>Margaret Smith</td>\n","    </tr>\n","    <tr>\n","      <th>24</th>\n","      <td>New Moon Books</td>\n","      <td>Martin Sommer</td>\n","    </tr>\n","    <tr>\n","      <th>25</th>\n","      <td>New Moon Books</td>\n","      <td>Matti Karttunen</td>\n","    </tr>\n","    <tr>\n","      <th>26</th>\n","      <td>Ramona Publishers</td>\n","      <td>Maria Pontes</td>\n","    </tr>\n","    <tr>\n","      <th>27</th>\n","      <td>New Moon Books</td>\n","      <td>Mary Saveley</td>\n","    </tr>\n","    <tr>\n","      <th>28</th>\n","      <td>Lucerne Publishing</td>\n","      <td>Patricia McKenna</td>\n","    </tr>\n","    <tr>\n","      <th>29</th>\n","      <td>New Moon Books</td>\n","      <td>Palle Ibsen</td>\n","    </tr>\n","    <tr>\n","      <th>30</th>\n","      <td>Binnet &amp; Hardley</td>\n","      <td>Peter Franken</td>\n","    </tr>\n","    <tr>\n","      <th>31</th>\n","      <td>Binnet &amp; Hardley</td>\n","      <td>Paolo Accorti</td>\n","    </tr>\n","    <tr>\n","      <th>32</th>\n","      <td>Lucerne Publishing</td>\n","      <td>Pirkko Koskitalo</td>\n","    </tr>\n","    <tr>\n","      <th>33</th>\n","      <td>Algodata Infosystems</td>\n","      <td>Pedro Afonso</td>\n","    </tr>\n","    <tr>\n","      <th>34</th>\n","      <td>Algodata Infosystems</td>\n","      <td>Paula Parente</td>\n","    </tr>\n","    <tr>\n","      <th>35</th>\n","      <td>Scootney Books</td>\n","      <td>Philip Cramer</td>\n","    </tr>\n","    <tr>\n","      <th>36</th>\n","      <td>Binnet &amp; Hardley</td>\n","      <td>Paul Henriot</td>\n","    </tr>\n","    <tr>\n","      <th>37</th>\n","      <td>New Moon Books</td>\n","      <td>Roland Mendel</td>\n","    </tr>\n","    <tr>\n","      <th>38</th>\n","      <td>Five Lakes Publishing</td>\n","      <td>Rita Muller</td>\n","    </tr>\n","    <tr>\n","      <th>39</th>\n","      <td>Algodata Infosystems</td>\n","      <td>Sven Ottlieb</td>\n","    </tr>\n","    <tr>\n","      <th>40</th>\n","      <td>New Moon Books</td>\n","      <td>Timothy O'Rourke</td>\n","    </tr>\n","    <tr>\n","      <th>41</th>\n","      <td>Binnet &amp; Hardley</td>\n","      <td>Victoria Ashworth</td>\n","    </tr>\n","    <tr>\n","      <th>42</th>\n","      <td>Algodata Infosystems</td>\n","      <td>Yoshi Latimer</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-eb3830d1-9705-47f1-978c-b5c3b4140e9c')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-eb3830d1-9705-47f1-978c-b5c3b4140e9c button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-eb3830d1-9705-47f1-978c-b5c3b4140e9c');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":76}]},{"cell_type":"markdown","metadata":{"id":"kqZ2u1To7zqq"},"source":["### Hint:"]},{"cell_type":"markdown","metadata":{"id":"61n9vsr07zqr"},"source":["In SQL the syntax is:\n","\n","```sql\n","Select E.fname,E.lname,P.pub_name\n","from employee E\n","left join publishers P\n","on E.pub_id=P.pub_id;\n","```"]},{"cell_type":"markdown","metadata":{"id":"eLK4xlpf7zqr"},"source":["## 5. Select the full name and job description of all employees."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"hgAQI-vy7zqs","colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"status":"ok","timestamp":1684178887935,"user_tz":-120,"elapsed":9,"user":{"displayName":"Valeriia Satsiuk","userId":"02455586528434910686"}},"outputId":"f76e4ba5-7765-4cbf-b967-0f81e3184d1d"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["             emp_name                     job_desc\n","0           Aria Cruz          Productions Manager\n","1      Annette Roulet              Managing Editor\n","2           Ann Devon  Business Operations Manager\n","3   Anabela Domingues     Public Relations Manager\n","4     Carlos Hernadez                    Publisher\n","5      Carine Schmitt         Sales Representative\n","6       Daniel Tonini           Operations Manager\n","7          Diego Roel              Managing Editor\n","8   Elizabeth Lincoln                     Designer\n","9     Francisco Chang     Chief Financial Officier\n","10        Gary Thomas         Acquisitions Manager\n","11      Helen Bennett                       Editor\n","12     Helvetius Nagy            Marketing Manager\n","13      Howard Snyder                       Editor\n","14     Janine Labrune                    Publisher\n","15      Karin Josephs                     Designer\n","16    Karla Jablonski         Acquisitions Manager\n","17       Lesley Brown            Marketing Manager\n","18   Laurence Lebihan                    Publisher\n","19      Maria Larsson            Marketing Manager\n","20     Manuel Pereira     Public Relations Manager\n","21      Martine Rance         Acquisitions Manager\n","22     Miguel Paolino           Operations Manager\n","23     Margaret Smith         Acquisitions Manager\n","24      Martin Sommer          Productions Manager\n","25    Matti Karttunen              Managing Editor\n","26       Maria Pontes                    Publisher\n","27       Mary Saveley     Public Relations Manager\n","28   Patricia McKenna           Operations Manager\n","29        Palle Ibsen            Marketing Manager\n","30      Peter Franken          Productions Manager\n","31      Paolo Accorti         Sales Representative\n","32   Pirkko Koskitalo          Productions Manager\n","33       Pedro Afonso                     Designer\n","34      Paula Parente     Public Relations Manager\n","35      Philip Cramer      Chief Executive Officer\n","36       Paul Henriot                    Publisher\n","37      Roland Mendel           Operations Manager\n","38        Rita Muller                    Publisher\n","39       Sven Ottlieb                    Publisher\n","40   Timothy O'Rourke         Sales Representative\n","41  Victoria Ashworth              Managing Editor\n","42      Yoshi Latimer                       Editor"],"text/html":["\n","  <div id=\"df-25250a49-1465-43b2-80b8-80dec391ead3\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>emp_name</th>\n","      <th>job_desc</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Aria Cruz</td>\n","      <td>Productions Manager</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Annette Roulet</td>\n","      <td>Managing Editor</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Ann Devon</td>\n","      <td>Business Operations Manager</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Anabela Domingues</td>\n","      <td>Public Relations Manager</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Carlos Hernadez</td>\n","      <td>Publisher</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>Carine Schmitt</td>\n","      <td>Sales Representative</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>Daniel Tonini</td>\n","      <td>Operations Manager</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>Diego Roel</td>\n","      <td>Managing Editor</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>Elizabeth Lincoln</td>\n","      <td>Designer</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>Francisco Chang</td>\n","      <td>Chief Financial Officier</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>Gary Thomas</td>\n","      <td>Acquisitions Manager</td>\n","    </tr>\n","    <tr>\n","      <th>11</th>\n","      <td>Helen Bennett</td>\n","      <td>Editor</td>\n","    </tr>\n","    <tr>\n","      <th>12</th>\n","      <td>Helvetius Nagy</td>\n","      <td>Marketing Manager</td>\n","    </tr>\n","    <tr>\n","      <th>13</th>\n","      <td>Howard Snyder</td>\n","      <td>Editor</td>\n","    </tr>\n","    <tr>\n","      <th>14</th>\n","      <td>Janine Labrune</td>\n","      <td>Publisher</td>\n","    </tr>\n","    <tr>\n","      <th>15</th>\n","      <td>Karin Josephs</td>\n","      <td>Designer</td>\n","    </tr>\n","    <tr>\n","      <th>16</th>\n","      <td>Karla Jablonski</td>\n","      <td>Acquisitions Manager</td>\n","    </tr>\n","    <tr>\n","      <th>17</th>\n","      <td>Lesley Brown</td>\n","      <td>Marketing Manager</td>\n","    </tr>\n","    <tr>\n","      <th>18</th>\n","      <td>Laurence Lebihan</td>\n","      <td>Publisher</td>\n","    </tr>\n","    <tr>\n","      <th>19</th>\n","      <td>Maria Larsson</td>\n","      <td>Marketing Manager</td>\n","    </tr>\n","    <tr>\n","      <th>20</th>\n","      <td>Manuel Pereira</td>\n","      <td>Public Relations Manager</td>\n","    </tr>\n","    <tr>\n","      <th>21</th>\n","      <td>Martine Rance</td>\n","      <td>Acquisitions Manager</td>\n","    </tr>\n","    <tr>\n","      <th>22</th>\n","      <td>Miguel Paolino</td>\n","      <td>Operations Manager</td>\n","    </tr>\n","    <tr>\n","      <th>23</th>\n","      <td>Margaret Smith</td>\n","      <td>Acquisitions Manager</td>\n","    </tr>\n","    <tr>\n","      <th>24</th>\n","      <td>Martin Sommer</td>\n","      <td>Productions Manager</td>\n","    </tr>\n","    <tr>\n","      <th>25</th>\n","      <td>Matti Karttunen</td>\n","      <td>Managing Editor</td>\n","    </tr>\n","    <tr>\n","      <th>26</th>\n","      <td>Maria Pontes</td>\n","      <td>Publisher</td>\n","    </tr>\n","    <tr>\n","      <th>27</th>\n","      <td>Mary Saveley</td>\n","      <td>Public Relations Manager</td>\n","    </tr>\n","    <tr>\n","      <th>28</th>\n","      <td>Patricia McKenna</td>\n","      <td>Operations Manager</td>\n","    </tr>\n","    <tr>\n","      <th>29</th>\n","      <td>Palle Ibsen</td>\n","      <td>Marketing Manager</td>\n","    </tr>\n","    <tr>\n","      <th>30</th>\n","      <td>Peter Franken</td>\n","      <td>Productions Manager</td>\n","    </tr>\n","    <tr>\n","      <th>31</th>\n","      <td>Paolo Accorti</td>\n","      <td>Sales Representative</td>\n","    </tr>\n","    <tr>\n","      <th>32</th>\n","      <td>Pirkko Koskitalo</td>\n","      <td>Productions Manager</td>\n","    </tr>\n","    <tr>\n","      <th>33</th>\n","      <td>Pedro Afonso</td>\n","      <td>Designer</td>\n","    </tr>\n","    <tr>\n","      <th>34</th>\n","      <td>Paula Parente</td>\n","      <td>Public Relations Manager</td>\n","    </tr>\n","    <tr>\n","      <th>35</th>\n","      <td>Philip Cramer</td>\n","      <td>Chief Executive Officer</td>\n","    </tr>\n","    <tr>\n","      <th>36</th>\n","      <td>Paul Henriot</td>\n","      <td>Publisher</td>\n","    </tr>\n","    <tr>\n","      <th>37</th>\n","      <td>Roland Mendel</td>\n","      <td>Operations Manager</td>\n","    </tr>\n","    <tr>\n","      <th>38</th>\n","      <td>Rita Muller</td>\n","      <td>Publisher</td>\n","    </tr>\n","    <tr>\n","      <th>39</th>\n","      <td>Sven Ottlieb</td>\n","      <td>Publisher</td>\n","    </tr>\n","    <tr>\n","      <th>40</th>\n","      <td>Timothy O'Rourke</td>\n","      <td>Sales Representative</td>\n","    </tr>\n","    <tr>\n","      <th>41</th>\n","      <td>Victoria Ashworth</td>\n","      <td>Managing Editor</td>\n","    </tr>\n","    <tr>\n","      <th>42</th>\n","      <td>Yoshi Latimer</td>\n","      <td>Editor</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-25250a49-1465-43b2-80b8-80dec391ead3')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-25250a49-1465-43b2-80b8-80dec391ead3 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-25250a49-1465-43b2-80b8-80dec391ead3');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":85}],"source":["emp_job = employee.merge(\n","    jobs,\n","    how='left',\n","    left_on='job_id',\n","    right_on='job_id'\n","    )\n","emp_job['emp_name']= emp_job['fname'] + ' ' + emp_job['lname']\n","emp_job[['emp_name', 'job_desc']]"]},{"cell_type":"markdown","metadata":{"id":"jdtjKz5S7zqs"},"source":["### Hint:"]},{"cell_type":"markdown","metadata":{"id":"Ka8HHqUc7zqt"},"source":["In SQL the syntax is:\n","\n","```sql\n","SELECT fname, lname, job_desc\n","FROM employee\n","LEFT JOIN jobs\n","ON employee.job_id = jobs.job_id;\n","```"]},{"cell_type":"markdown","metadata":{"id":"MFfBXBgw7zqt"},"source":["## 6. Select the full name, job description and publisher name of all employees\n","   Hint: you will have to perform 2 joins in a single query to merge 3 tables together."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"eIdwCXsB7zqt","colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"status":"ok","timestamp":1684219077399,"user_tz":-120,"elapsed":6,"user":{"displayName":"Valeriia Satsiuk","userId":"02455586528434910686"}},"outputId":"dc2cd00f-d8bd-4067-e33e-3258b1db5a1b"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["             emp_name                     job_desc               pub_name\n","0           Aria Cruz          Productions Manager   Algodata Infosystems\n","1      Annette Roulet              Managing Editor     Lucerne Publishing\n","2           Ann Devon  Business Operations Manager         Scootney Books\n","3   Anabela Domingues     Public Relations Manager       Binnet & Hardley\n","4     Carlos Hernadez                    Publisher     Lucerne Publishing\n","5      Carine Schmitt         Sales Representative   Algodata Infosystems\n","6       Daniel Tonini           Operations Manager       Binnet & Hardley\n","7          Diego Roel              Managing Editor   Algodata Infosystems\n","8   Elizabeth Lincoln                     Designer       Binnet & Hardley\n","9     Francisco Chang     Chief Financial Officier         Scootney Books\n","10        Gary Thomas         Acquisitions Manager         New Moon Books\n","11      Helen Bennett                       Editor       Binnet & Hardley\n","12     Helvetius Nagy            Marketing Manager     Lucerne Publishing\n","13      Howard Snyder                       Editor         New Moon Books\n","14     Janine Labrune                    Publisher                  GGG&G\n","15      Karin Josephs                     Designer         New Moon Books\n","16    Karla Jablonski         Acquisitions Manager     Lucerne Publishing\n","17       Lesley Brown            Marketing Manager       Binnet & Hardley\n","18   Laurence Lebihan                    Publisher         New Moon Books\n","19      Maria Larsson            Marketing Manager   Algodata Infosystems\n","20     Manuel Pereira     Public Relations Manager     Lucerne Publishing\n","21      Martine Rance         Acquisitions Manager       Binnet & Hardley\n","22     Miguel Paolino           Operations Manager   Algodata Infosystems\n","23     Margaret Smith         Acquisitions Manager   Algodata Infosystems\n","24      Martin Sommer          Productions Manager         New Moon Books\n","25    Matti Karttunen              Managing Editor         New Moon Books\n","26       Maria Pontes                    Publisher      Ramona Publishers\n","27       Mary Saveley     Public Relations Manager         New Moon Books\n","28   Patricia McKenna           Operations Manager     Lucerne Publishing\n","29        Palle Ibsen            Marketing Manager         New Moon Books\n","30      Peter Franken          Productions Manager       Binnet & Hardley\n","31      Paolo Accorti         Sales Representative       Binnet & Hardley\n","32   Pirkko Koskitalo          Productions Manager     Lucerne Publishing\n","33       Pedro Afonso                     Designer   Algodata Infosystems\n","34      Paula Parente     Public Relations Manager   Algodata Infosystems\n","35      Philip Cramer      Chief Executive Officer         Scootney Books\n","36       Paul Henriot                    Publisher       Binnet & Hardley\n","37      Roland Mendel           Operations Manager         New Moon Books\n","38        Rita Muller                    Publisher  Five Lakes Publishing\n","39       Sven Ottlieb                    Publisher   Algodata Infosystems\n","40   Timothy O'Rourke         Sales Representative         New Moon Books\n","41  Victoria Ashworth              Managing Editor       Binnet & Hardley\n","42      Yoshi Latimer                       Editor   Algodata Infosystems"],"text/html":["\n","  <div id=\"df-4e8d28af-d077-472e-b0ad-fe4b2a14a29b\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>emp_name</th>\n","      <th>job_desc</th>\n","      <th>pub_name</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Aria Cruz</td>\n","      <td>Productions Manager</td>\n","      <td>Algodata Infosystems</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Annette Roulet</td>\n","      <td>Managing Editor</td>\n","      <td>Lucerne Publishing</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Ann Devon</td>\n","      <td>Business Operations Manager</td>\n","      <td>Scootney Books</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Anabela Domingues</td>\n","      <td>Public Relations Manager</td>\n","      <td>Binnet &amp; Hardley</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Carlos Hernadez</td>\n","      <td>Publisher</td>\n","      <td>Lucerne Publishing</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>Carine Schmitt</td>\n","      <td>Sales Representative</td>\n","      <td>Algodata Infosystems</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>Daniel Tonini</td>\n","      <td>Operations Manager</td>\n","      <td>Binnet &amp; Hardley</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>Diego Roel</td>\n","      <td>Managing Editor</td>\n","      <td>Algodata Infosystems</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>Elizabeth Lincoln</td>\n","      <td>Designer</td>\n","      <td>Binnet &amp; Hardley</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>Francisco Chang</td>\n","      <td>Chief Financial Officier</td>\n","      <td>Scootney Books</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>Gary Thomas</td>\n","      <td>Acquisitions Manager</td>\n","      <td>New Moon Books</td>\n","    </tr>\n","    <tr>\n","      <th>11</th>\n","      <td>Helen Bennett</td>\n","      <td>Editor</td>\n","      <td>Binnet &amp; Hardley</td>\n","    </tr>\n","    <tr>\n","      <th>12</th>\n","      <td>Helvetius Nagy</td>\n","      <td>Marketing Manager</td>\n","      <td>Lucerne Publishing</td>\n","    </tr>\n","    <tr>\n","      <th>13</th>\n","      <td>Howard Snyder</td>\n","      <td>Editor</td>\n","      <td>New Moon Books</td>\n","    </tr>\n","    <tr>\n","      <th>14</th>\n","      <td>Janine Labrune</td>\n","      <td>Publisher</td>\n","      <td>GGG&amp;G</td>\n","    </tr>\n","    <tr>\n","      <th>15</th>\n","      <td>Karin Josephs</td>\n","      <td>Designer</td>\n","      <td>New Moon Books</td>\n","    </tr>\n","    <tr>\n","      <th>16</th>\n","      <td>Karla Jablonski</td>\n","      <td>Acquisitions Manager</td>\n","      <td>Lucerne Publishing</td>\n","    </tr>\n","    <tr>\n","      <th>17</th>\n","      <td>Lesley Brown</td>\n","      <td>Marketing Manager</td>\n","      <td>Binnet &amp; Hardley</td>\n","    </tr>\n","    <tr>\n","      <th>18</th>\n","      <td>Laurence Lebihan</td>\n","      <td>Publisher</td>\n","      <td>New Moon Books</td>\n","    </tr>\n","    <tr>\n","      <th>19</th>\n","      <td>Maria Larsson</td>\n","      <td>Marketing Manager</td>\n","      <td>Algodata Infosystems</td>\n","    </tr>\n","    <tr>\n","      <th>20</th>\n","      <td>Manuel Pereira</td>\n","      <td>Public Relations Manager</td>\n","      <td>Lucerne Publishing</td>\n","    </tr>\n","    <tr>\n","      <th>21</th>\n","      <td>Martine Rance</td>\n","      <td>Acquisitions Manager</td>\n","      <td>Binnet &amp; Hardley</td>\n","    </tr>\n","    <tr>\n","      <th>22</th>\n","      <td>Miguel Paolino</td>\n","      <td>Operations Manager</td>\n","      <td>Algodata Infosystems</td>\n","    </tr>\n","    <tr>\n","      <th>23</th>\n","      <td>Margaret Smith</td>\n","      <td>Acquisitions Manager</td>\n","      <td>Algodata Infosystems</td>\n","    </tr>\n","    <tr>\n","      <th>24</th>\n","      <td>Martin Sommer</td>\n","      <td>Productions Manager</td>\n","      <td>New Moon Books</td>\n","    </tr>\n","    <tr>\n","      <th>25</th>\n","      <td>Matti Karttunen</td>\n","      <td>Managing Editor</td>\n","      <td>New Moon Books</td>\n","    </tr>\n","    <tr>\n","      <th>26</th>\n","      <td>Maria Pontes</td>\n","      <td>Publisher</td>\n","      <td>Ramona Publishers</td>\n","    </tr>\n","    <tr>\n","      <th>27</th>\n","      <td>Mary Saveley</td>\n","      <td>Public Relations Manager</td>\n","      <td>New Moon Books</td>\n","    </tr>\n","    <tr>\n","      <th>28</th>\n","      <td>Patricia McKenna</td>\n","      <td>Operations Manager</td>\n","      <td>Lucerne Publishing</td>\n","    </tr>\n","    <tr>\n","      <th>29</th>\n","      <td>Palle Ibsen</td>\n","      <td>Marketing Manager</td>\n","      <td>New Moon Books</td>\n","    </tr>\n","    <tr>\n","      <th>30</th>\n","      <td>Peter Franken</td>\n","      <td>Productions Manager</td>\n","      <td>Binnet &amp; Hardley</td>\n","    </tr>\n","    <tr>\n","      <th>31</th>\n","      <td>Paolo Accorti</td>\n","      <td>Sales Representative</td>\n","      <td>Binnet &amp; Hardley</td>\n","    </tr>\n","    <tr>\n","      <th>32</th>\n","      <td>Pirkko Koskitalo</td>\n","      <td>Productions Manager</td>\n","      <td>Lucerne Publishing</td>\n","    </tr>\n","    <tr>\n","      <th>33</th>\n","      <td>Pedro Afonso</td>\n","      <td>Designer</td>\n","      <td>Algodata Infosystems</td>\n","    </tr>\n","    <tr>\n","      <th>34</th>\n","      <td>Paula Parente</td>\n","      <td>Public Relations Manager</td>\n","      <td>Algodata Infosystems</td>\n","    </tr>\n","    <tr>\n","      <th>35</th>\n","      <td>Philip Cramer</td>\n","      <td>Chief Executive Officer</td>\n","      <td>Scootney Books</td>\n","    </tr>\n","    <tr>\n","      <th>36</th>\n","      <td>Paul Henriot</td>\n","      <td>Publisher</td>\n","      <td>Binnet &amp; Hardley</td>\n","    </tr>\n","    <tr>\n","      <th>37</th>\n","      <td>Roland Mendel</td>\n","      <td>Operations Manager</td>\n","      <td>New Moon Books</td>\n","    </tr>\n","    <tr>\n","      <th>38</th>\n","      <td>Rita Muller</td>\n","      <td>Publisher</td>\n","      <td>Five Lakes Publishing</td>\n","    </tr>\n","    <tr>\n","      <th>39</th>\n","      <td>Sven Ottlieb</td>\n","      <td>Publisher</td>\n","      <td>Algodata Infosystems</td>\n","    </tr>\n","    <tr>\n","      <th>40</th>\n","      <td>Timothy O'Rourke</td>\n","      <td>Sales Representative</td>\n","      <td>New Moon Books</td>\n","    </tr>\n","    <tr>\n","      <th>41</th>\n","      <td>Victoria Ashworth</td>\n","      <td>Managing Editor</td>\n","      <td>Binnet &amp; Hardley</td>\n","    </tr>\n","    <tr>\n","      <th>42</th>\n","      <td>Yoshi Latimer</td>\n","      <td>Editor</td>\n","      <td>Algodata Infosystems</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-4e8d28af-d077-472e-b0ad-fe4b2a14a29b')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-4e8d28af-d077-472e-b0ad-fe4b2a14a29b button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-4e8d28af-d077-472e-b0ad-fe4b2a14a29b');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":8}],"source":["emp_pub = employee.merge(\n","    publishers,\n","    how='left',\n","    left_on='pub_id',\n","    right_on='pub_id'\n",")\n","emp_pub_job = emp_pub.merge(\n","    jobs,\n","    how='left',\n","    left_on='job_id',\n","    right_on='job_id'\n",")\n","emp_pub_job['emp_name'] = emp_pub_job['fname'] + ' ' + emp_pub_job['lname']\n","emp_pub_job[['emp_name', 'job_desc', 'pub_name']]\n"]},{"cell_type":"markdown","metadata":{"id":"1y6brzk17zqu"},"source":["### Hint:"]},{"cell_type":"markdown","metadata":{"id":"F9A95Gt37zqu"},"source":["In SQL the syntax is:\n","\n","```sql\n","SELECT fname, lname, job_desc, pub_name\n","FROM employee\n","LEFT JOIN publishers\n","ON employee.pub_id = publishers.pub_id\n","LEFT JOIN jobs\n","ON employee.job_id = jobs.job_id;\n","```"]},{"cell_type":"markdown","metadata":{"id":"tSrmGaqv7zqu"},"source":["## 7. Select the full name, job description and publisher name of employees that work for Binnet & Hardley."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"23duWrkH7zqv","colab":{"base_uri":"https://localhost:8080/","height":359},"executionInfo":{"status":"ok","timestamp":1684219550179,"user_tz":-120,"elapsed":9,"user":{"displayName":"Valeriia Satsiuk","userId":"02455586528434910686"}},"outputId":"d91bb27b-34e6-4640-c755-f3f77e3c0b63"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["             emp_name          pub_name                  job_desc\n","3   Anabela Domingues  Binnet & Hardley  Public Relations Manager\n","6       Daniel Tonini  Binnet & Hardley        Operations Manager\n","8   Elizabeth Lincoln  Binnet & Hardley                  Designer\n","11      Helen Bennett  Binnet & Hardley                    Editor\n","17       Lesley Brown  Binnet & Hardley         Marketing Manager\n","21      Martine Rance  Binnet & Hardley      Acquisitions Manager\n","30      Peter Franken  Binnet & Hardley       Productions Manager\n","31      Paolo Accorti  Binnet & Hardley      Sales Representative\n","36       Paul Henriot  Binnet & Hardley                 Publisher\n","41  Victoria Ashworth  Binnet & Hardley           Managing Editor"],"text/html":["\n","  <div id=\"df-644f6a29-0ad6-4fa0-9e88-61419b32407a\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>emp_name</th>\n","      <th>pub_name</th>\n","      <th>job_desc</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>3</th>\n","      <td>Anabela Domingues</td>\n","      <td>Binnet &amp; Hardley</td>\n","      <td>Public Relations Manager</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>Daniel Tonini</td>\n","      <td>Binnet &amp; Hardley</td>\n","      <td>Operations Manager</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>Elizabeth Lincoln</td>\n","      <td>Binnet &amp; Hardley</td>\n","      <td>Designer</td>\n","    </tr>\n","    <tr>\n","      <th>11</th>\n","      <td>Helen Bennett</td>\n","      <td>Binnet &amp; Hardley</td>\n","      <td>Editor</td>\n","    </tr>\n","    <tr>\n","      <th>17</th>\n","      <td>Lesley Brown</td>\n","      <td>Binnet &amp; Hardley</td>\n","      <td>Marketing Manager</td>\n","    </tr>\n","    <tr>\n","      <th>21</th>\n","      <td>Martine Rance</td>\n","      <td>Binnet &amp; Hardley</td>\n","      <td>Acquisitions Manager</td>\n","    </tr>\n","    <tr>\n","      <th>30</th>\n","      <td>Peter Franken</td>\n","      <td>Binnet &amp; Hardley</td>\n","      <td>Productions Manager</td>\n","    </tr>\n","    <tr>\n","      <th>31</th>\n","      <td>Paolo Accorti</td>\n","      <td>Binnet &amp; Hardley</td>\n","      <td>Sales Representative</td>\n","    </tr>\n","    <tr>\n","      <th>36</th>\n","      <td>Paul Henriot</td>\n","      <td>Binnet &amp; Hardley</td>\n","      <td>Publisher</td>\n","    </tr>\n","    <tr>\n","      <th>41</th>\n","      <td>Victoria Ashworth</td>\n","      <td>Binnet &amp; Hardley</td>\n","      <td>Managing Editor</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-644f6a29-0ad6-4fa0-9e88-61419b32407a')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-644f6a29-0ad6-4fa0-9e88-61419b32407a button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-644f6a29-0ad6-4fa0-9e88-61419b32407a');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":22}],"source":["emp_pub_job.loc[(emp_pub_job['pub_name'] == 'Binnet & Hardley'), ['emp_name', 'pub_name', 'job_desc']]"]},{"cell_type":"code","source":["pub_jobs = (\n","employee\n","    .merge(right = publishers, how = 'left', on = 'pub_id')\n","    .merge(right = jobs, how = 'left', on = 'job_id') \n",")\n","\n","(\n","pub_jobs\n","    .loc[pub_jobs['pub_name']=='Binnet & Hardley']\n","    [['fname', 'lname', 'job_desc', 'pub_name']]\n",")\n","#SOLUTION\n"],"metadata":{"id":"MGYbrMNrTcDm"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"9DB7Ec7W7zqv"},"source":["### Hint:"]},{"cell_type":"markdown","metadata":{"id":"C4GqSOIV7zqv"},"source":["In SQL the syntax is:\n","\n","```sql\n","SELECT fname, lname, job_desc, pub_name\n","FROM employee\n","LEFT JOIN publishers\n","ON employee.pub_id=publishers.pub_id\n","LEFT JOIN jobs\n","ON employee.job_id=jobs.job_id\n","WHERE pub_name='Binnet & Hardley';\n","```"]},{"cell_type":"markdown","metadata":{"id":"7iihJUZd7zqw"},"source":["## 8. Select the name and PR Info (from the pub_info table) from all publishers based in Berkeley, California."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"6GIAJtaj7zqy","colab":{"base_uri":"https://localhost:8080/","height":80},"executionInfo":{"status":"ok","timestamp":1684219961681,"user_tz":-120,"elapsed":8,"user":{"displayName":"Valeriia Satsiuk","userId":"02455586528434910686"}},"outputId":"a8a061c3-ee1c-47ef-9a76-b3ef3f8ab848"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["               pub_name                                            pr_info\n","2  Algodata Infosystems  This is sample text data for Algodata Infosyst..."],"text/html":["\n","  <div id=\"df-7a11ab42-ce68-47dd-8316-9bc4cbeac4ea\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>pub_name</th>\n","      <th>pr_info</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>2</th>\n","      <td>Algodata Infosystems</td>\n","      <td>This is sample text data for Algodata Infosyst...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-7a11ab42-ce68-47dd-8316-9bc4cbeac4ea')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-7a11ab42-ce68-47dd-8316-9bc4cbeac4ea button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-7a11ab42-ce68-47dd-8316-9bc4cbeac4ea');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":31}],"source":["pub_i=publishers.merge(\n","    pub_info,\n","    how='left',\n","    left_on='pub_id',\n","    right_on='pub_id'\n",")\n","pub_i.loc[(pub_i['city'] == 'Berkeley'), ['pub_name', 'pr_info']]\n"]},{"cell_type":"code","source":["(\n","publishers\n","    .merge(right = pub_info, how = 'left', on = 'pub_id')\n","    .loc[(publishers['state']=='CA')\n","        &(publishers['city']=='Berkeley')]\n","    [['pub_name', 'pr_info']]\n",")\n","#SOLUTION"],"metadata":{"id":"ydrUnCt4Ms3X"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"D0nfJSn_7zqz"},"source":["### Hint:"]},{"cell_type":"markdown","metadata":{"id":"Aou1FbR87zqz"},"source":["In SQL the syntax is:\n","\n","```sql\n","select pub_name, pub_info.pr_info\n","from publishers\n","left join pub_info\n","on pub_info.pub_id = publishers.pub_id\n","where city in (\"Berkeley\") and state='CA';\n","\n","```"]},{"cell_type":"markdown","metadata":{"id":"BCnBjd4R7zq0"},"source":["## 9. Selet all columns from the discounts table.\n","   Observe the columns it has and now some of them are filled with NULL values."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"DrdMtpfJ7zq1","colab":{"base_uri":"https://localhost:8080/","height":142},"executionInfo":{"status":"ok","timestamp":1684220000341,"user_tz":-120,"elapsed":338,"user":{"displayName":"Valeriia Satsiuk","userId":"02455586528434910686"}},"outputId":"73106d53-744f-40c0-fec6-76758ff7789e"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["        discounttype  stor_id  lowqty  highqty  discount\n","0   Initial Customer      NaN       0        0      10.5\n","1    Volume Discount      NaN     100     1000       6.7\n","2  Customer Discount   8042.0       0        0       5.0"],"text/html":["\n","  <div id=\"df-a6c59517-d5de-4b5a-a6fc-0c9dffd52506\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>discounttype</th>\n","      <th>stor_id</th>\n","      <th>lowqty</th>\n","      <th>highqty</th>\n","      <th>discount</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Initial Customer</td>\n","      <td>NaN</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>10.5</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Volume Discount</td>\n","      <td>NaN</td>\n","      <td>100</td>\n","      <td>1000</td>\n","      <td>6.7</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Customer Discount</td>\n","      <td>8042.0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>5.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a6c59517-d5de-4b5a-a6fc-0c9dffd52506')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-a6c59517-d5de-4b5a-a6fc-0c9dffd52506 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-a6c59517-d5de-4b5a-a6fc-0c9dffd52506');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":32}],"source":["discounts"]},{"cell_type":"markdown","metadata":{"id":"udoBef9g7zq1"},"source":["### Hint:"]},{"cell_type":"markdown","metadata":{"id":"i3EY1RV37zq2"},"source":["In SQL the syntax is:\n","\n","```sql\n","SELECT * FROM discounts;\n","```"]},{"cell_type":"markdown","metadata":{"id":"i_j1FAp47zq3"},"source":["## 10. Select all store names, their store id and the discounts they offer.\n","\n","\t   - When selecting the store id, select it two times: from the stores table\n","         and from the discounts table.\n","         \n","       - ALL stores should be displayed, even if they don't offer any discount \n","         (i.e. have a NULL value on the discount column)."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"6cFziZnj7zq3","colab":{"base_uri":"https://localhost:8080/","height":607},"executionInfo":{"status":"ok","timestamp":1684220432630,"user_tz":-120,"elapsed":8,"user":{"displayName":"Valeriia Satsiuk","userId":"02455586528434910686"}},"outputId":"c5f47edd-cae7-42cb-c1a8-b3e3c21e4947"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                               stor_name  stor_id_x  stor_id_y  discount\n","0                    Eric the Read Books       6380        NaN      10.5\n","1                    Eric the Read Books       6380        NaN       6.7\n","2                    Eric the Read Books       6380     8042.0       5.0\n","3                               Barnum's       7066        NaN      10.5\n","4                               Barnum's       7066        NaN       6.7\n","5                               Barnum's       7066     8042.0       5.0\n","6                           News & Brews       7067        NaN      10.5\n","7                           News & Brews       7067        NaN       6.7\n","8                           News & Brews       7067     8042.0       5.0\n","9   Doc-U-Mat: Quality Laundry and Books       7131        NaN      10.5\n","10  Doc-U-Mat: Quality Laundry and Books       7131        NaN       6.7\n","11  Doc-U-Mat: Quality Laundry and Books       7131     8042.0       5.0\n","12                    Fricative Bookshop       7896        NaN      10.5\n","13                    Fricative Bookshop       7896        NaN       6.7\n","14                    Fricative Bookshop       7896     8042.0       5.0\n","15                              Bookbeat       8042        NaN      10.5\n","16                              Bookbeat       8042        NaN       6.7\n","17                              Bookbeat       8042     8042.0       5.0"],"text/html":["\n","  <div id=\"df-95b6f50c-cdda-4f93-aba3-33bf7dd32f66\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>stor_name</th>\n","      <th>stor_id_x</th>\n","      <th>stor_id_y</th>\n","      <th>discount</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Eric the Read Books</td>\n","      <td>6380</td>\n","      <td>NaN</td>\n","      <td>10.5</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Eric the Read Books</td>\n","      <td>6380</td>\n","      <td>NaN</td>\n","      <td>6.7</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Eric the Read Books</td>\n","      <td>6380</td>\n","      <td>8042.0</td>\n","      <td>5.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Barnum's</td>\n","      <td>7066</td>\n","      <td>NaN</td>\n","      <td>10.5</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Barnum's</td>\n","      <td>7066</td>\n","      <td>NaN</td>\n","      <td>6.7</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>Barnum's</td>\n","      <td>7066</td>\n","      <td>8042.0</td>\n","      <td>5.0</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>News &amp; Brews</td>\n","      <td>7067</td>\n","      <td>NaN</td>\n","      <td>10.5</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>News &amp; Brews</td>\n","      <td>7067</td>\n","      <td>NaN</td>\n","      <td>6.7</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>News &amp; Brews</td>\n","      <td>7067</td>\n","      <td>8042.0</td>\n","      <td>5.0</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>Doc-U-Mat: Quality Laundry and Books</td>\n","      <td>7131</td>\n","      <td>NaN</td>\n","      <td>10.5</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>Doc-U-Mat: Quality Laundry and Books</td>\n","      <td>7131</td>\n","      <td>NaN</td>\n","      <td>6.7</td>\n","    </tr>\n","    <tr>\n","      <th>11</th>\n","      <td>Doc-U-Mat: Quality Laundry and Books</td>\n","      <td>7131</td>\n","      <td>8042.0</td>\n","      <td>5.0</td>\n","    </tr>\n","    <tr>\n","      <th>12</th>\n","      <td>Fricative Bookshop</td>\n","      <td>7896</td>\n","      <td>NaN</td>\n","      <td>10.5</td>\n","    </tr>\n","    <tr>\n","      <th>13</th>\n","      <td>Fricative Bookshop</td>\n","      <td>7896</td>\n","      <td>NaN</td>\n","      <td>6.7</td>\n","    </tr>\n","    <tr>\n","      <th>14</th>\n","      <td>Fricative Bookshop</td>\n","      <td>7896</td>\n","      <td>8042.0</td>\n","      <td>5.0</td>\n","    </tr>\n","    <tr>\n","      <th>15</th>\n","      <td>Bookbeat</td>\n","      <td>8042</td>\n","      <td>NaN</td>\n","      <td>10.5</td>\n","    </tr>\n","    <tr>\n","      <th>16</th>\n","      <td>Bookbeat</td>\n","      <td>8042</td>\n","      <td>NaN</td>\n","      <td>6.7</td>\n","    </tr>\n","    <tr>\n","      <th>17</th>\n","      <td>Bookbeat</td>\n","      <td>8042</td>\n","      <td>8042.0</td>\n","      <td>5.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-95b6f50c-cdda-4f93-aba3-33bf7dd32f66')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-95b6f50c-cdda-4f93-aba3-33bf7dd32f66 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-95b6f50c-cdda-4f93-aba3-33bf7dd32f66');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":45}],"source":["sto_dis = stores.merge(\n","    discounts,\n","    how='cross'\n",")\n","sto_dis[['stor_name', 'stor_id_x', 'stor_id_y', 'discount']]"]},{"cell_type":"code","source":["(\n","stores\n","    .merge(right = discounts, how = 'left', on = 'stor_id')\n","    [['stor_name', 'stor_id', 'discounttype', 'discount']]\n",")\n"],"metadata":{"id":"hiV6diZwM-xM"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"JV5DloIh7zq3"},"source":["### Hint:"]},{"cell_type":"markdown","metadata":{"id":"VsjSx_Xj7zq4"},"source":["In SQL the syntax is:\n","\n","```sql\n","SELECT d.stor_id AS disstor, d.discount, s.stor_id AS storid, s.stor_name \n","FROM iscounts AS d\n","RIGHT JOIN stores AS s\n","ON d.stor_id=s.stor_id;\n","\n","```"]},{"cell_type":"markdown","metadata":{"id":"r3sxbFZB7zq4"},"source":["## 11. Select all store names and the discounts they offer.\n","\n","       - This time, we don't want do display stores that don't offer any \n","         discount.\n","\n","    Hint: change the join type!"]},{"cell_type":"code","execution_count":2,"metadata":{"id":"zlb8uBfz7zq4","colab":{"base_uri":"https://localhost:8080/","height":80},"executionInfo":{"status":"ok","timestamp":1684393445736,"user_tz":-120,"elapsed":11,"user":{"displayName":"Valeriia Satsiuk","userId":"02455586528434910686"}},"outputId":"8724905f-110b-46f6-c357-cb70c2c343e8"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["  stor_name  stor_id       discounttype  discount\n","0  Bookbeat     8042  Customer Discount       5.0"],"text/html":["\n","  <div id=\"df-38670848-2f05-4150-afec-1992dd5119d4\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>stor_name</th>\n","      <th>stor_id</th>\n","      <th>discounttype</th>\n","      <th>discount</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Bookbeat</td>\n","      <td>8042</td>\n","      <td>Customer Discount</td>\n","      <td>5.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-38670848-2f05-4150-afec-1992dd5119d4')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-38670848-2f05-4150-afec-1992dd5119d4 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-38670848-2f05-4150-afec-1992dd5119d4');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":2}],"source":["sto_dis_all = stores.merge(\n","    discounts,\n","    how='inner',\n","    left_on='stor_id',\n","    right_on='stor_id'\n",")\n","sto_dis_all[['stor_name', 'stor_id', 'discounttype', 'discount']]"]},{"cell_type":"code","source":["(\n","stores\n","    .merge(right = discounts, how = 'inner', on = 'stor_id')\n","    [['stor_name', 'stor_id', 'discounttype', 'discount']]\n",")"],"metadata":{"id":"UOsbjaamNRuO"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"cIX_PZl8rM2x"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"FhyiVNhj7zq4"},"source":["### Hint:"]},{"cell_type":"markdown","metadata":{"id":"mnIedagv7zq5"},"source":["In SQL the syntax is:\n","\n","```sql\n","select St.stor_name,St.stor_id ,D.discount\n","from  stores St \n","inner join discounts  D on St.stor_id=D.stor_id ;\n","```"]}],"metadata":{"kernelspec":{"display_name":"base","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.9.15 (main, Nov  4 2022, 16:35:55) [MSC v.1916 64 bit (AMD64)]"},"orig_nbformat":4,"vscode":{"interpreter":{"hash":"ad2bdc8ecc057115af97d19610ffacc2b4e99fae6737bb82f5d7fb13d2f2c186"}},"colab":{"provenance":[{"file_id":"1B99Z2ayqF_iLhX7AU0lKQNd_9Z1tCNFe","timestamp":1684173540686}]}},"nbformat":4,"nbformat_minor":0}