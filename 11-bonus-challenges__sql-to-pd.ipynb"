{"cells":[{"cell_type":"markdown","metadata":{"id":"sN57mBmegRcv"},"source":["# From SQL to pandas challenge 11"]},{"cell_type":"code","execution_count":4,"metadata":{"id":"KwLTgP6EgRcz","executionInfo":{"status":"ok","timestamp":1684340444996,"user_tz":-120,"elapsed":5848,"user":{"displayName":"Valeriia Satsiuk","userId":"02455586528434910686"}}},"outputs":[],"source":["# import libraries\n","import pandas as pd\n","\n","# load data\n","# This code is made to load our data stored on Google Drive\n","def gd_path(file_id):\n","    \"\"\"Generate a shareable link from Google Drive file id.\"\"\"\n","    return f\"https://drive.google.com/uc?export=download&id={file_id}\"\n","\n","# Google Drive file ids\n","files_id = {\n","    \"titleauthor\": \"1F1JOiYXStWacOBca6coNVfyVtoST7ZgD\",\n","    \"titles\": \"1PLdn50N9GRa53ZbuVWo0l47F_IXdvlEm\",\n","     \"stores\": \"1f-GCgip7O93CpbAkYvOsc21eKnSOSHsQ\", \n","    \"sales\": \"1fzFc9rwYmVIPaGOFmhLVxCi3kg19vNU2\", \n","    \"roysched\": \"1zPRZPoFPEMKyrNR5VSENeYFHGCBZmxbs\", \n","    \"publishers\": \"1s9E8_AVOziTrowb3wyh2jg3PV763VOyq\",\n","    \"employee\": \"1h9mUjsVqpP74b1w0x7KOw37n_n9Ulkt5\", \n","    \"authors\": \"1fEF89Nhe61EebAljKlwFwfEuokK0o6aJ\"\n","}\n","\n","# Read data from Google Drive\n","sales = pd.read_csv(gd_path(files_id[\"sales\"]), sep=\";\")\n","titles = pd.read_csv(gd_path(files_id[\"titles\"]), sep=\";\")\n","stores = pd.read_csv(gd_path(files_id[\"stores\"]), sep=\";\")\n","publishers = pd.read_csv(gd_path(files_id[\"publishers\"]), sep=\";\")\n","employee = pd.read_csv(gd_path(files_id[\"employee\"]), sep=\";\")\n","authors = pd.read_csv(gd_path(files_id[\"authors\"]), sep=\";\")\n","titleauthor = pd.read_csv(gd_path(files_id[\"titleauthor\"]), sep=\";\")\n","roysched = pd.read_csv(gd_path(files_id[\"roysched\"]), sep=\";\")"]},{"cell_type":"markdown","metadata":{"id":"qpzwxzT7gRc1"},"source":["## 1. Using LEFT JOIN: in which cities has \"Is Anger the Enemy?\" been sold?"]},{"cell_type":"code","execution_count":5,"metadata":{"id":"r6HnKWw6gRc2","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1684340449560,"user_tz":-120,"elapsed":264,"user":{"displayName":"Valeriia Satsiuk","userId":"02455586528434910686"}},"outputId":"3d3d6551-1fe8-4e88-ca67-4b314c122d20"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array(['Seattle', 'Tustin', 'Los Gatos', 'Remulade'], dtype=object)"]},"metadata":{},"execution_count":5}],"source":["tit_sal_sto = titles.merge(\n","    sales,\n","    how='left',\n","    left_on='title_id',\n","    right_on='title_id'\n",")\n","title_stor_id = tit_sal_sto[['title', 'stor_id']]\n","title_sales = title_stor_id.merge(\n","    stores,\n","    how='left',\n","    left_on='stor_id',\n","    right_on='stor_id'\n",")\n","title_sales.loc[(title_sales['title'] == 'Is Anger the Enemy?'), 'city'].unique()"]},{"cell_type":"code","source":["pd.Series(title_sales.loc[(title_sales['title'] == 'Is Anger the Enemy?'), 'city'].unique())"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"-2_IpGQz49kr","executionInfo":{"status":"ok","timestamp":1684346891639,"user_tz":-120,"elapsed":269,"user":{"displayName":"Valeriia Satsiuk","userId":"02455586528434910686"}},"outputId":"aefb3e79-b40f-4b2c-b684-1df197e8456a"},"execution_count":12,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0      Seattle\n","1       Tustin\n","2    Los Gatos\n","3     Remulade\n","dtype: object"]},"metadata":{},"execution_count":12}]},{"cell_type":"markdown","metadata":{"id":"tOmF0CVZgRc2"},"source":["### Hint:"]},{"cell_type":"markdown","metadata":{"id":"Y3j0xg5UgRc2"},"source":["In SQL the syntax is:\n","\n","```sql\n","SELECT p.city\n","FROM publishers AS p\n","LEFT JOIN titles AS t\n","ON p.pub_id = t.pub_id\n","WHERE t.title = 'Is Anger the Enemy?';\n","```"]},{"cell_type":"markdown","metadata":{"id":"NrNqYOTFgRc3"},"source":["## 2. Select all the book titles that have a link to the employee Howard Snyder \n","    (he works for the publisher that has published those books)."]},{"cell_type":"code","execution_count":9,"metadata":{"id":"-HtJ3-dzgRc4","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1684340479305,"user_tz":-120,"elapsed":6,"user":{"displayName":"Valeriia Satsiuk","userId":"02455586528434910686"}},"outputId":"cb70cc10-80e2-45a7-a33a-e0791b946569"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["21                   You Can Combat Computer Stress!\n","111                              Is Anger the Enemy?\n","121                                Life Without Fear\n","131    Prolonged Data Deprivation: Four Case Studies\n","141              Emotional Security: A New Algorithm\n","Name: title, dtype: object"]},"metadata":{},"execution_count":9}],"source":["tit_emp = titles.merge(\n","    employee,\n","    how='left',\n","    left_on='pub_id',\n","    right_on='pub_id'\n",")\n","tit_emp['emp_name'] = tit_emp['fname'] + ' ' + tit_emp['lname']\n","tit_emp.loc[(tit_emp['emp_name'] == 'Howard Snyder'), 'title']"]},{"cell_type":"markdown","metadata":{"id":"6URMuYL-gRc4"},"source":["### Hint:"]},{"cell_type":"markdown","metadata":{"id":"aUx_Q7TfgRc5"},"source":["In SQL the syntax is:\n","\n","```sql\n","SELECT t.title\n","FROM employee e\n","JOIN titles t\n","ON e.pub_id = t.pub_id\n","WHERE e.fname = 'Howard'\n","AND e.lname = 'Snyder';\n","```"]},{"cell_type":"markdown","metadata":{"id":"apRweaNzgRc5"},"source":["## 3. Using the `merge` of your choice: Select the book title with highest number of sales (qty)"]},{"cell_type":"code","execution_count":27,"metadata":{"id":"Wl-0zxitgRc5","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1684258650865,"user_tz":-120,"elapsed":386,"user":{"displayName":"Valeriia Satsiuk","userId":"02455586528434910686"}},"outputId":"307ab4eb-c087-4678-9989-f617f0ef7dcb"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["title\n","Is Anger the Enemy?    108.0\n","Name: qty, dtype: float64"]},"metadata":{},"execution_count":27}],"source":["tit_sal = titles.merge(\n","    sales,\n","    how='left',\n","    left_on='title_id',\n","    right_on='title_id'\n",")\n","tit_sal.groupby('title').qty.sum().sort_values(ascending=False).head(1)"]},{"cell_type":"markdown","metadata":{"id":"ubdiM7DzgRc5"},"source":["### Hint:"]},{"cell_type":"markdown","metadata":{"id":"rtbkAWnHgRc6"},"source":["In SQL the syntax is:\n","\n","```sql\n","SELECT t.title, SUM(qty)\n","FROM sales AS s \n","JOIN titles t\n","ON s.title_id = t.title_id\n","GROUP BY t.title_id\n","ORDER BY SUM(qty) desc\n","LIMIT 1;\n","```"]},{"cell_type":"markdown","metadata":{"id":"qekLbWzdgRc6"},"source":["# 4. Select all book titles and the full name of their author(s).\n","      \n","      - If a book has multiple authors, all authors must be displayed (in \n","      multiple rows).\n","      \n","      - Books with no authors and authors with no books should not be displayed."]},{"cell_type":"code","source":["(\n","titles\n","    .merge(right = titleauthor, how = 'inner', on = 'title_id')\n","    .merge(right = authors, how = 'inner', on = 'au_id')\n","    [['title', 'au_lname', 'au_fname']]\n",")"],"metadata":{"id":"4j6L8_cI7vz4"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":15,"metadata":{"id":"52I6WrS6gRc6","colab":{"base_uri":"https://localhost:8080/","height":824},"executionInfo":{"status":"ok","timestamp":1684347194712,"user_tz":-120,"elapsed":281,"user":{"displayName":"Valeriia Satsiuk","userId":"02455586528434910686"}},"outputId":"fb022d88-7482-4cf5-ba9d-7bf2a198b4a3"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                                title                  au_name\n","0                 The Busy Executive's Database Guide           Marjorie Green\n","1                     You Can Combat Computer Stress!           Marjorie Green\n","2                 The Busy Executive's Database Guide           Abraham Bennet\n","3   Cooking with Computers: Surreptitious Balance ...          Michael O'Leary\n","4                                      Sushi, Anyone?          Michael O'Leary\n","5   Cooking with Computers: Surreptitious Balance ...       Stearns MacFeather\n","6   Computer Phobic AND Non-Phobic Individuals: Be...       Stearns MacFeather\n","7                       Straight Talk About Computers            Dean Straight\n","8                   Silicon Valley Gastronomic Treats       Innes del Castillo\n","9                               The Gourmet Microwave          Michel DeFrance\n","10                              The Gourmet Microwave              Anne Ringer\n","11                                Is Anger the Enemy?              Anne Ringer\n","12                           But Is It User Friendly?            Cheryl Carson\n","13                          Secrets of Silicon Valley                 Ann Dull\n","14                          Secrets of Silicon Valley            Sheryl Hunter\n","15                                      Net Etiquette        Charlene Locksley\n","16                Emotional Security: A New Algorithm        Charlene Locksley\n","17  Computer Phobic AND Non-Phobic Individuals: Be...             Livia Karsen\n","18                                Is Anger the Enemy?            Albert Ringer\n","19                                  Life Without Fear            Albert Ringer\n","20      Prolonged Data Deprivation: Four Case Studies            Johnson White\n","21  Onions, Leeks, and Garlic: Cooking Secrets of ...          Sylvia Panteley\n","22          Fifty Years in Buckingham Palace Kitchens  Reginald Blotchet-Halls\n","23                                     Sushi, Anyone?          Burt Gringlesby\n","24                                     Sushi, Anyone?           Akiko Yokomoto"],"text/html":["\n","  <div id=\"df-2aedcab6-66ca-4d71-834f-9ac9ce964228\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>title</th>\n","      <th>au_name</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>The Busy Executive's Database Guide</td>\n","      <td>Marjorie Green</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>You Can Combat Computer Stress!</td>\n","      <td>Marjorie Green</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>The Busy Executive's Database Guide</td>\n","      <td>Abraham Bennet</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Cooking with Computers: Surreptitious Balance ...</td>\n","      <td>Michael O'Leary</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Sushi, Anyone?</td>\n","      <td>Michael O'Leary</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>Cooking with Computers: Surreptitious Balance ...</td>\n","      <td>Stearns MacFeather</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>Computer Phobic AND Non-Phobic Individuals: Be...</td>\n","      <td>Stearns MacFeather</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>Straight Talk About Computers</td>\n","      <td>Dean Straight</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>Silicon Valley Gastronomic Treats</td>\n","      <td>Innes del Castillo</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>The Gourmet Microwave</td>\n","      <td>Michel DeFrance</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>The Gourmet Microwave</td>\n","      <td>Anne Ringer</td>\n","    </tr>\n","    <tr>\n","      <th>11</th>\n","      <td>Is Anger the Enemy?</td>\n","      <td>Anne Ringer</td>\n","    </tr>\n","    <tr>\n","      <th>12</th>\n","      <td>But Is It User Friendly?</td>\n","      <td>Cheryl Carson</td>\n","    </tr>\n","    <tr>\n","      <th>13</th>\n","      <td>Secrets of Silicon Valley</td>\n","      <td>Ann Dull</td>\n","    </tr>\n","    <tr>\n","      <th>14</th>\n","      <td>Secrets of Silicon Valley</td>\n","      <td>Sheryl Hunter</td>\n","    </tr>\n","    <tr>\n","      <th>15</th>\n","      <td>Net Etiquette</td>\n","      <td>Charlene Locksley</td>\n","    </tr>\n","    <tr>\n","      <th>16</th>\n","      <td>Emotional Security: A New Algorithm</td>\n","      <td>Charlene Locksley</td>\n","    </tr>\n","    <tr>\n","      <th>17</th>\n","      <td>Computer Phobic AND Non-Phobic Individuals: Be...</td>\n","      <td>Livia Karsen</td>\n","    </tr>\n","    <tr>\n","      <th>18</th>\n","      <td>Is Anger the Enemy?</td>\n","      <td>Albert Ringer</td>\n","    </tr>\n","    <tr>\n","      <th>19</th>\n","      <td>Life Without Fear</td>\n","      <td>Albert Ringer</td>\n","    </tr>\n","    <tr>\n","      <th>20</th>\n","      <td>Prolonged Data Deprivation: Four Case Studies</td>\n","      <td>Johnson White</td>\n","    </tr>\n","    <tr>\n","      <th>21</th>\n","      <td>Onions, Leeks, and Garlic: Cooking Secrets of ...</td>\n","      <td>Sylvia Panteley</td>\n","    </tr>\n","    <tr>\n","      <th>22</th>\n","      <td>Fifty Years in Buckingham Palace Kitchens</td>\n","      <td>Reginald Blotchet-Halls</td>\n","    </tr>\n","    <tr>\n","      <th>23</th>\n","      <td>Sushi, Anyone?</td>\n","      <td>Burt Gringlesby</td>\n","    </tr>\n","    <tr>\n","      <th>24</th>\n","      <td>Sushi, Anyone?</td>\n","      <td>Akiko Yokomoto</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-2aedcab6-66ca-4d71-834f-9ac9ce964228')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-2aedcab6-66ca-4d71-834f-9ac9ce964228 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-2aedcab6-66ca-4d71-834f-9ac9ce964228');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":15}],"source":["tit_aut = titles.merge(\n","    titleauthor,\n","    how='inner',\n","    left_on='title_id',\n","    right_on='title_id'\n",")\n","tit_aut_name = tit_aut.merge(\n","    authors,\n","    how='inner',\n","    left_on='au_id',\n","    right_on='au_id'\n",")\n","tit_aut_name['au_name'] = tit_aut_name['au_fname'] + ' ' + tit_aut_name['au_lname']\n","tit_aut_name[['title','au_name']]"]},{"cell_type":"markdown","source":["authors"],"metadata":{"id":"lm1PjBY86wI5"}},{"cell_type":"markdown","metadata":{"id":"neqNQ915gRc6"},"source":["### Hint:"]},{"cell_type":"markdown","metadata":{"id":"braNElh4gRc6"},"source":["In SQL the syntax is:\n","\n","```sql\n","SELECT\n","    t.title,\n","    a.au_fname,\n","    a.au_lname\n","FROM titles t\n","INNER JOIN titleauthor ta \n","ON t.title_id = ta.title_id\n","INNER JOIN authors a \n","ON ta.au_id = a.au_id;\n","```"]},{"cell_type":"markdown","metadata":{"id":"v9-tI2-LgRc6"},"source":["## 5. Select the full name of authors of Psychology books\n","\n","   Bonus hint: if you want to prevent duplicates but allow authors with shared\n","   last names to be displayed, you can concatenate the first and last names\n","   with CONCAT(), and use the DISTINCT clause on the concatenated names."]},{"cell_type":"code","execution_count":52,"metadata":{"id":"vK75ErHMgRc6","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1684259360798,"user_tz":-120,"elapsed":6,"user":{"displayName":"Valeriia Satsiuk","userId":"02455586528434910686"}},"outputId":"31110654-aa0f-422e-e185-e9fe85768060"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array(['Stearns MacFeather', 'Livia Karsen', 'Anne Ringer',\n","       'Albert Ringer', 'Johnson White', 'Charlene Locksley'],\n","      dtype=object)"]},"metadata":{},"execution_count":52}],"source":["tit_aut = titles.merge(\n","    titleauthor,\n","    how='left',\n","    left_on='title_id',\n","    right_on='title_id'\n",")\n","tit_aut_name = tit_aut.merge(\n","    authors,\n","    how='left',\n","    left_on='au_id',\n","    right_on='au_id'\n",")\n","tit_aut_name['au_name'] = tit_aut_name['au_fname'] + ' ' + tit_aut_name['au_lname']\n","tit_aut_name.loc[(tit_aut_name['type'] == 'psychology'), 'au_name'].unique()"]},{"cell_type":"markdown","metadata":{"id":"5N4uTFmLgRc7"},"source":["### Hint:"]},{"cell_type":"markdown","metadata":{"id":"X3SviDXmgRc7"},"source":["In SQL the syntax is:\n","\n","```sql\n","SELECT DISTINCT CONCAT(a.au_fname, \" \", a.au_lname) AS full_name\n","FROM authors a\n","INNER JOIN titleauthor ta ON a.au_id = ta.au_id\n","INNER JOIN titles t ON ta.title_id = t.title_id\n","WHERE t.type = \"Psychology\";\n","```"]},{"cell_type":"markdown","metadata":{"id":"wYTmpl3tgRc7"},"source":["## 6. Explore the table roysched and try to grasp the meaning of each column. \n","   The notes below will help:\n","   \n","   - \"Royalty\" means the percentage of the sale price paid to the author(s).\n","   \n","   - Sometimes, the royalty may be smaller for the first few sales (which have\n","     to cover the publishing costs to the publisher) but higher for the sales \n","     above a certain threshold.\n","     \n","   - In the \"roysched\" table each title_id can appear multiple times, with\n","     different royalty values for each range of sales.\n","     \n","   - Select all rows for particular title_id, for example \"BU1111\", and explore\n","\t the data."]},{"cell_type":"code","execution_count":57,"metadata":{"id":"vyo1e7ixgRc7","colab":{"base_uri":"https://localhost:8080/","height":297},"executionInfo":{"status":"ok","timestamp":1684259728910,"user_tz":-120,"elapsed":232,"user":{"displayName":"Valeriia Satsiuk","userId":"02455586528434910686"}},"outputId":"579a84e1-c653-4b0e-b6b2-b8b833d56abc"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["   title_id  lorange  hirange  royalty\n","49   BU1111        0     4000       10\n","50   BU1111     4001     8000       12\n","51   BU1111     8001    10000       14\n","52   BU1111    12001    16000       16\n","53   BU1111    16001    20000       18\n","54   BU1111    20001    24000       20\n","55   BU1111    24001    28000       22\n","56   BU1111    28001    50000       24"],"text/html":["\n","  <div id=\"df-6cec6f4e-0f67-4b4f-989b-91aa19a1f956\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>title_id</th>\n","      <th>lorange</th>\n","      <th>hirange</th>\n","      <th>royalty</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>49</th>\n","      <td>BU1111</td>\n","      <td>0</td>\n","      <td>4000</td>\n","      <td>10</td>\n","    </tr>\n","    <tr>\n","      <th>50</th>\n","      <td>BU1111</td>\n","      <td>4001</td>\n","      <td>8000</td>\n","      <td>12</td>\n","    </tr>\n","    <tr>\n","      <th>51</th>\n","      <td>BU1111</td>\n","      <td>8001</td>\n","      <td>10000</td>\n","      <td>14</td>\n","    </tr>\n","    <tr>\n","      <th>52</th>\n","      <td>BU1111</td>\n","      <td>12001</td>\n","      <td>16000</td>\n","      <td>16</td>\n","    </tr>\n","    <tr>\n","      <th>53</th>\n","      <td>BU1111</td>\n","      <td>16001</td>\n","      <td>20000</td>\n","      <td>18</td>\n","    </tr>\n","    <tr>\n","      <th>54</th>\n","      <td>BU1111</td>\n","      <td>20001</td>\n","      <td>24000</td>\n","      <td>20</td>\n","    </tr>\n","    <tr>\n","      <th>55</th>\n","      <td>BU1111</td>\n","      <td>24001</td>\n","      <td>28000</td>\n","      <td>22</td>\n","    </tr>\n","    <tr>\n","      <th>56</th>\n","      <td>BU1111</td>\n","      <td>28001</td>\n","      <td>50000</td>\n","      <td>24</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-6cec6f4e-0f67-4b4f-989b-91aa19a1f956')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-6cec6f4e-0f67-4b4f-989b-91aa19a1f956 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-6cec6f4e-0f67-4b4f-989b-91aa19a1f956');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":57}],"source":["roysched.loc[(roysched['title_id'] == 'BU1111'), :]"]},{"cell_type":"markdown","metadata":{"id":"WDnmWBmCgRc7"},"source":["### Hint:"]},{"cell_type":"markdown","metadata":{"id":"Zq-7LxdbgRc8"},"source":["In SQL the syntax is:\n","\n","```sql\n","SELECT * FROM roysched WHERE title_id = \"BU1111\";\n","```"]},{"cell_type":"markdown","metadata":{"id":"vnAzkOmxgRc8"},"source":["## 7. Select all the book titles and the maximum royalty they can reach.\n","    Display only titles that are present in the roysched table."]},{"cell_type":"code","execution_count":62,"metadata":{"id":"AxtXCkO6gRc8","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1684259953140,"user_tz":-120,"elapsed":5,"user":{"displayName":"Valeriia Satsiuk","userId":"02455586528434910686"}},"outputId":"67f36ed8-a74c-49cf-cdd4-e8b59bb09827"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["title\n","But Is It User Friendly?                                           18.0\n","Computer Phobic AND Non-Phobic Individuals: Behavior Variations    18.0\n","Cooking with Computers: Surreptitious Balance Sheets               24.0\n","Emotional Security: A New Algorithm                                12.0\n","Fifty Years in Buckingham Palace Kitchens                          22.0\n","Is Anger the Enemy?                                                16.0\n","Life Without Fear                                                  16.0\n","Net Etiquette                                                       NaN\n","Onions, Leeks, and Garlic: Cooking Secrets of the Mediterranean    24.0\n","Prolonged Data Deprivation: Four Case Studies                      16.0\n","Secrets of Silicon Valley                                          16.0\n","Silicon Valley Gastronomic Treats                                  20.0\n","Straight Talk About Computers                                      24.0\n","Sushi, Anyone?                                                     14.0\n","The Busy Executive's Database Guide                                12.0\n","The Gourmet Microwave                                              24.0\n","The Psychology of Computer Cooking                                  NaN\n","You Can Combat Computer Stress!                                    24.0\n","Name: royalty_y, dtype: float64"]},"metadata":{},"execution_count":62}],"source":["tit_roy = titles.merge(\n","    roysched,\n","    how='left',\n","    left_on='title_id',\n","    right_on='title_id'\n",")\n","tit_roy.groupby('title').royalty_y.max()"]},{"cell_type":"markdown","metadata":{"id":"bew086gegRc8"},"source":["### Hint:"]},{"cell_type":"markdown","metadata":{"id":"cGSV9L6agRc8"},"source":["In SQL the syntax is:\n","\n","```sql\n","SELECT t.title, MAX(r.royalty) max_royalty\n","FROM titles t\n","INNER JOIN roysched r \n","ON t.title_id = r.title_id\n","GROUP BY t.title\n","ORDER BY max_royalty DESC;\n","```"]}],"metadata":{"kernelspec":{"display_name":"base","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.9.15 (main, Nov  4 2022, 16:35:55) [MSC v.1916 64 bit (AMD64)]"},"orig_nbformat":4,"vscode":{"interpreter":{"hash":"ad2bdc8ecc057115af97d19610ffacc2b4e99fae6737bb82f5d7fb13d2f2c186"}},"colab":{"provenance":[{"file_id":"1v6zToSxcAkXXDWan_9A1DksZSpHxfINr","timestamp":1684222744729}]}},"nbformat":4,"nbformat_minor":0}